<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comparateur de CHART Crypto</title>
  <!--<link rel="stylesheet" href="./style.css">-->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/luxon@3.3.0/build/global/luxon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.0"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.20/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.20/dist/sweetalert2.all.min.js"></script>
  <style>
    root {
      --background-color: #f1f1f1;
      --text-color: #000000;
      --primary-color: #58a6ff;
      --secondary-color: #f1f3f4;
      --border-color: #dcdcdc;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --input-background: #f9f9f9;
    }

    s *::before,
    *::after {
      box-sizing: border-box;
    }

    body {
      margin: 20px;
      background-color: var(--background-color);
      color: white;
      font-family: sans-serif;
      text-align: center;
    }

    header {
      margin-top: 20px;
      margin-left: 20px;
      color: grey;
    }

    .hamburger-menu {
      width: 40px;
      height: 20px;
      top: 20px;
      left: 20px;
      position: fixed;
      color: grey;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      cursor: pointer;
    }

    .hamburger-menu span {
      width: 100%;
      height: 2px;
      background-color: grey;
    }

    span {
      text-decoration: none;
      color: grey;
    }

    canvas {
      width: 100%;
      margin: 20px auto;
      display: block;
    }

    input,
    button {
      margin: 5px;
      padding: 8px;
      border-radius: 8px;
    }

    a {
      color: #ab9ff2;
      text-decoration: none;
    }

    a:hover {
      color: grey;
      text-decoration: none;
    }

    footer {
      width: 100%;
      height: auto;
      background: transparent;
      color: grey;
      padding: 2rem 1rem;
      text-align: center;
      box-shadow: 0px -2px 0px -2px #a7a6a6;

    }

    .footer-content {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
    }

    .footer-section {
      margin: 1rem;
    }

    .footer-section h3 {
      margin-bottom: 1rem;
    }

    .footer-section ul {
      list-style: none;
      padding: 0;
    }

    .footer-section ul li {
      margin-bottom: 0.5rem;
    }

    .footer-section ul li a {
      color: #ab9ff2;
      text-decoration: none;
    }

    .footer-section ul li a:hover {
      color: grey;
    }
  </style>
</head>
<header>
  <div class="hamburger-menu">
    <img src="https://img.icons8.com/?size=100&id=36389&format=png&color=808080">
  </div>

</header>

<body>
  <h1>Comparateur de Crypto</h1>
  <input type="text" id="cryptoInput" placeholder="Entrez un token (ex: bitcoin)">
  <button onclick="addCrypto()">Ajouter</button>
  <button onclick="clearChart()">Réinitialiser</button>
  <canvas id="cryptoChart"></canvas>
  <br>
  <footer>
    <div class="footer-content">
      <div class="footer-section links">
        <h3>Other tool</h3>
        <ul>
          <li><a href="../index.html">FiboScope</a></li>
          <li><a href="../wallet/index.html">Wallet</a></li>
          <li><a href="../alarm/index.html">Alarm</a></li>

        </ul>
      </div>
      <div class="footer-section links">
        <h3>Libre acces</h3>
        <ul>
          <li><a href="https://savoir-relatif-et-absolu.netlify.app/#espace-commentaire">Contact</a></li>
          <li><a href="https://github.com/berru-g/FiboScope/tree/main/superpose">Code source</a></li>
          <li><a href="https://berru-g.github.io/berru-g/blog/donation.html">donation</a></li>
        </ul>
      </div>
    </div>
    <h5>Crypto tool &copy; 2025 | by <a href="https://github.com/berru-g/FiboScope/blob/main/license.txt">berru-g</a>
    </h5>
  </footer>

  <script>
    let chart;
    let cryptoData = {};

    async function fetchCryptoData(crypto) {
      try {
        const response = await fetch(`https://api.coingecko.com/api/v3/coins/${crypto}/market_chart?vs_currency=usd&days=7`);
        if (!response.ok) throw new Error("Notez le nom complet avec un tiret si nécessaire. Ex: pour btc notez bitcoin, pour injective notez injective-protocol, pour Akash notez akash-network, pour RSR notez reserve-rights-token etc");
        const data = await response.json();
        return data.prices.map(entry => ({ x: entry[0], y: entry[1] }));
      } catch (error) {
        alert("Erreur: " + error.message);
        return null;
      }
    }

    async function addCrypto() {
      const crypto = document.getElementById("cryptoInput").value.toLowerCase().trim();
      if (!crypto || cryptoData[crypto]) return;
      const data = await fetchCryptoData(crypto);
      if (data) {
        cryptoData[crypto] = data;
        updateChart();
      }
    }

    function updateChart() {
      const ctx = document.getElementById('cryptoChart').getContext('2d');
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: Object.keys(cryptoData).map((crypto, index) => ({
            label: crypto,
            data: cryptoData[crypto],
            borderColor: ['#264653', '#2a9d8f', '#e9c46a', '#f4a261', '#e76f51'][index % 5],
            fill: false
          }))
        },
        options: {
          scales: { x: { type: 'time', time: { unit: 'day' } } },
          responsive: true
        }
      });
    }

    function clearChart() {
      cryptoData = {};
      updateChart();
    }

    // menu
    const hamburgerMenu = document.querySelector('.hamburger-menu');

    hamburgerMenu.addEventListener('click', () => {
      // Utilisation de SweetAlert pour afficher la fenêtre contextuelle
      Swal.fire({
        title: 'free Tool',
        html: '<ul><p><a href="../index.html">fiboscope</a> fibonacci tool</p><p><a href="../alarm/index.html">Alarm Crypto</a></p><p><a href="../wallet/index.html">Wallet</a></p><p><a href="../superpose/index.html">Multi Chart</a></p><p><a href="https://medium.com/@gael-berru">Article</a></p><p><a href="https://berru-g.github.io/berru-g/blog/donation.html">Donation</a></p></ul>',
        showCloseButton: true,
        showConfirmButton: false,
        customClass: {
          popup: 'custom-swal-popup',
          closeButton: 'custom-swal-close-button',
          content: 'custom-swal-content',
        }
      });
    });

  </script>
</body>

</html>